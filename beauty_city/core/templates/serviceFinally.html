{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Beauty City - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" integrity="sha512-yHknP1/AwR+yx26cB1y0cjvQUMvEa2PFzt1c9LlS4pRQ5NOTZFWbhBig+X9G9eYW/8m0/4OXNx8pxJ6z57x0dw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="{% static 'css/jquery.arcticmodal-0.3.css' %}">
	<link rel="stylesheet" href="{% static 'css/simple.css' %}">
	<link rel="stylesheet" href="{% static 'css/bootstrap-grid.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/air-datepicker.css' %}">
	<link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body>
	<section id="mobMenu">
			<div class="mobMenu">
				<div class="container">
				<div class="mobMenu__header">
					<div class="row">
						<div class="col-4 col-md-3">
							<a href="/">
								<img src="{% static 'img/Logo.svg' %}" alt="Logo" class="logo header__logo">
							</a>
						</div>
						<div class="col-3 col-md-2">
							<img src="{% static 'img/x.svg' %}" alt="x" class="mobMenuClose">
						</div>
					</div>
				</div>
				<div class="mobMenu__content">
					<div class="row">
						<div class="col-md-3">
							<nav>
								<ul class="mobMenu__menu">
									<li class="mobMenu__menu_item">
										<a href="#" class="mobMenu__menu_link">–ú–∞—Å—Ç–µ—Ä–∞</a>
									</li>
									<li class="mobMenu__menu_item"><a href="#" class="mobMenu__menu_link">–£—Å–ª—É–≥–∏</a></li>
									<li class="mobMenu__menu_item"><a href="#" class="mobMenu__menu_link">–û—Ç–∑—ã–≤—ã</a></li>
									<li class="mobMenu__menu_item"><a href="#" class="mobMenu__menu_link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
								</ul>
							</nav>
							<a href="#" class="mobMenu__account">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
						</div>
					</div>
					<div class="row">
						<div class="col-md-12">
							<a href="#contacts" class="mobMenu__btn">–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç–µ –º–Ω–µ</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<header id="header">
		<div class="container">
			<div class="header">
				<div class="row">
					<div class="col-2 col-md-2 mob">
						<img src="{% static 'img/hamburger.svg' %}" alt="hamburger" class="header__mobMenu">
					</div>
					<div class="col-5 col-md-3 col-lg-2">
						<a href="/">
							<img src="{% static 'img/Logo.svg' %}" alt="Logo" class="logo header__logo">
						</a>
					</div>
					<div class="col-md-5 ">
						<nav>
						<ul class="menu">
							<li class="menu__item"><a href="#" class="menu__item_link">–ú–∞—Å—Ç–µ—Ä–∞</a></li>
							<li class="menu__item"><a href="#" class="menu__item_link">–£—Å–ª—É–≥–∏</a></li>
							<li class="menu__item"><a href="#" class="menu__item_link">–û—Ç–∑—ã–≤—ã</a></li>
							<li class="menu__item"><a href="#" class="menu__item_link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
						</ul>
					</nav>
					</div>
					<div class="col-2 col-md-2 col-lg-3">
						<div class="header__block">
						<button class="header__block_btn">–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç–µ –º–Ω–µ</button>
						<div class="header__block_auth">
							<img src="{% static 'img/acc.svg' %}" alt="account" class="header__account_img">
							<span class="header__block_auth__intro">–í–æ–π—Ç–∏</span>
						</div>
					</div>
					</div>
				</div>
			</div>
		</div>
	</header>

	<section id="serviceFinally">
		<div class="container">
			<div class="serviceFinally">
				{% if error %}
					<div class="error-alert" style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
						‚ö†Ô∏è {{ error }}
						<a href="{% url 'service' %}" style="display: block; margin-top: 10px;">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É —É—Å–ª—É–≥–∏</a>
					</div>
				{% endif %}

				<div class="row">
					<div class="col-md-7 col-lg-7">
						<div class="breadCrumbs">
							<a href="{% url 'index' %}" class="breadCrumbs__item">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a> /
							<a href="{% url 'service' %}" class="breadCrumbs__item">–í—ã–±–æ—Ä —É—Å–ª—É–≥–∏</a>
						</div>

						<div class="service__block">
							<h1 class="service__title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏</h1>
						</div>

						<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö -->
						{% if selected_salon and selected_procedure and selected_specialist %}
							<div class="selected-params" style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin-bottom: 30px;">
								<h3 style="margin-bottom: 20px;">‚úÖ –í—ã –≤—ã–±—Ä–∞–ª–∏:</h3>

								<div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
									<strong>–°–∞–ª–æ–Ω:</strong><br>
									{{ selected_salon.name }}<br>
									<small style="color: #666;">{{ selected_salon.address }}</small>
								</div>

								<div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
									<strong>–£—Å–ª—É–≥–∞:</strong><br>
									{{ selected_procedure.title }}<br>
									<small style="color: #28a745; font-weight: bold;">{{ selected_procedure.base_price }} ‚ÇΩ</small>
								</div>

								<div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
									<strong>–ú–∞—Å—Ç–µ—Ä:</strong><br>
									{{ selected_specialist.full_name }}
								</div>

								<div style="margin-bottom: 15px;">
									<strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</strong><br>
									{{ selected_date }} –≤ {{ selected_time }}
								</div>
							</div>

							<!-- –§–æ—Ä–º–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ -->
							<form method="POST"
								  action="{% url 'service_finally' %}?salon={{ selected_salon.id }}&procedure={{ selected_procedure.id }}&specialist={{ selected_specialist.id }}&date={{ selected_date }}&time={{ selected_time }}"
								  style="background: white; border-radius: 10px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
								{% csrf_token %}

								<!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã -->
								{{ form.salon }}
								{{ form.procedure }}
								{{ form.specialist }}

								<h3 style="margin-bottom: 25px;">üìù –í–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>

								<!-- –ò–º—è -->
								<div style="margin-bottom: 25px;">
									<label style="display: block; margin-bottom: 8px; font-weight: 500;">–ò–º—è *</label>
									{{ form.customer_name }}
									{% if form.customer_name.errors %}
										<div style="color: #dc3545; font-size: 14px; margin-top: 5px;">
											{{ form.customer_name.errors.0 }}
										</div>
									{% endif %}
								</div>

								<!-- –¢–µ–ª–µ—Ñ–æ–Ω -->
								<div style="margin-bottom: 25px;">
									<label style="display: block; margin-bottom: 8px; font-weight: 500;">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
									{{ form.phone }}
									{% if form.phone.errors %}
										<div style="color: #dc3545; font-size: 14px; margin-top: 5px;">
											{{ form.phone.errors.0 }}
										</div>
									{% endif %}
									<small style="color: #666; font-size: 14px;">–ù–∞ —ç—Ç–æ—Ç –Ω–æ–º–µ—Ä –ø—Ä–∏–¥–µ—Ç SMS —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º</small>
								</div>

								<!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
								<div style="margin-bottom: 25px;">
									<label style="display: block; margin-bottom: 8px; font-weight: 500;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
									{{ form.question }}
								</div>

								<!-- –°–æ–≥–ª–∞—Å–∏–µ -->
								<div style="margin: 25px 0;">
									<input type="checkbox" id="privacyPolicy" required style="margin-right: 10px;">
									<label for="privacyPolicy" style="color: #666;">
										–Ø —Å–æ–≥–ª–∞—Å–µ–Ω(–∞) —Å
										<a href="#" style="color: #007bff; text-decoration: none;">–ø–æ–ª–∏—Ç–∏–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</a> *
									</label>
								</div>

								<!-- –ö–Ω–æ–ø–∫–∏ -->
								<div style="display: flex; flex-direction: column; gap: 15px; margin-top: 30px;">
									<button type="submit"
											style="background: #28a745; color: white; border: none; padding: 16px; border-radius: 8px; font-size: 18px; font-weight: 600; cursor: pointer; transition: background 0.3s;">
										‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –∏ –æ–ø–ª–∞—Ç–∏—Ç—å {{ selected_procedure.base_price }} ‚ÇΩ
									</button>

									<a href="{% url 'service' %}"
									   style="display: inline-block; text-align: center; color: #6c757d; text-decoration: none; padding: 12px; border: 1px solid #ddd; border-radius: 6px;">
										‚Ü© –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –≤—Ä–µ–º–µ–Ω–∏
									</a>
								</div>

								<div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
									<p style="color: #666;">–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏:</p>
									<div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px;">
										<span style="background: #f8f9fa; padding: 5px 10px; border-radius: 5px;">üí≥ –û–Ω–ª–∞–π–Ω (–ÆKassa)</span>
										<span style="background: #f8f9fa; padding: 5px 10px; border-radius: 5px;">üè¢ –ù–∞–ª–∏—á–Ω—ã–º–∏ –≤ —Å–∞–ª–æ–Ω–µ</span>
									</div>
								</div>
							</form>
						{% else %}
							<div style="background: #fff3cd; color: #856404; padding: 20px; border-radius: 5px; margin: 20px 0;">
								‚ö†Ô∏è –ù–µ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–±—Ä–∞–Ω—ã.
								<a href="{% url 'service' %}" style="display: block; margin-top: 10px;">–í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ –≤—ã–±–æ—Ä—É —É—Å–ª—É–≥–∏</a>
							</div>
						{% endif %}
					</div>

					<div class="col-md-5 col-lg-5">
						<!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
						<div class="info-sidebar">
							<div style="background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
								<h4 style="margin-bottom: 15px;">üìç –ê–¥—Ä–µ—Å —Å–∞–ª–æ–Ω–∞</h4>
								{% if selected_salon %}
									<p>{{ selected_salon.address }}</p>
									{% if selected_salon.phone %}
										<p style="color: #28a745;">üìû {{ selected_salon.phone }}</p>
									{% endif %}
								{% endif %}
							</div>

							<div style="background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
								<h4 style="margin-bottom: 15px;">üí° –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å</h4>
								<ul style="padding-left: 20px;">
									<li style="margin-bottom: 10px;">–ü—Ä–∏—Ö–æ–¥–∏—Ç–µ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –∑–∞–ø–∏—Å–∏</li>
									<li style="margin-bottom: 10px;">–û—Ç–º–µ–Ω–∞ –∑–∞ 24 —á–∞—Å–∞ - –ø–æ–ª–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç</li>
									<li>–ü—Ä–∏ –æ–ø–æ–∑–¥–∞–Ω–∏–∏ –±–æ–ª–µ–µ 15 –º–∏–Ω—É—Ç –∑–∞–ø–∏—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω–∞</li>
								</ul>
							</div>

							<div style="background: #fff3cd; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
								<h4 style="margin-bottom: 15px;">‚ö†Ô∏è –í–∞–∂–Ω–æ!</h4>
								<p>–ó–∞–ø–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã.
								–í—ã –º–æ–∂–µ—Ç–µ –æ–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å –æ–Ω–ª–∞–π–Ω –∏–ª–∏ –≤ —Å–∞–ª–æ–Ω–µ								<h4 style="margin-bottom: 15px;">‚ùì –í–æ–ø—Ä–æ—Å—ã?</h4>
								<p>–ó–≤–æ–Ω–∏—Ç–µ:</p>
								<a href="tel:+78001234567"
								   style="display: inline-block; background: #17a2b8; color: white; padding: 10px 15px; border-radius: 5px; text-decoration: none; margin: 10px 0;">
									üìû 8 (800) 123-45-67
								</a>
							</div>

							<!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
							<div style="margin-top: 30px;">
								<img src="{% static 'img/bannerImg.svg' %}" alt="bannerImg" style="width: 100%; border-radius: 10px;">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π footer ... -->

	<script>
		$(document).ready(function() {
			// –ú–∞—Å–∫–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
			$('input[name="phone"]').on('input', function() {
				let value = $(this).val().replace(/\D/g, '');
				if (value.length > 0) {
					if (value[0] !== '7' && value[0] !== '8') {
						value = '7' + value;
					}
					let formatted = '+7';
					if (value.length > 1) {
						formatted += ' (' + value.substring(1, 4);
					}
					if (value.length > 4) {
						formatted += ') ' + value.substring(4, 7);
					}
					if (value.length > 7) {
						formatted += '-' + value.substring(7, 9);
					}
					if (value.length > 9) {
						formatted += '-' + value.substring(9, 11);
					}
					$(this).val(formatted);
				}
			});

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—ã
			$('form').on('submit', function(e) {
				const phone = $('input[name="phone"]').val();
				const name = $('input[name="customer_name"]').val();
				const privacy = $('#privacyPolicy').is(':checked');

				if (!name || name.trim().length < 2) {
					alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è (–º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞)');
					e.preventDefault();
					return false;
				}

				if (!phone || !phone.match(/^\+7\s?\(\d{3}\)\s?\d{3}-\d{2}-\d{2}$/)) {
					alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7 (999) 999-99-99');
					e.preventDefault();
					return false;
				}

				if (!privacy) {
					alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏');
					e.preventDefault();
					return false;
				}

				// –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–∞–¥–µ—Ä
				$(this).find('button[type="submit"]')
					.html('‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞...')
					.prop('disabled', true);
			});
		});
	</script>
</body>
</html>